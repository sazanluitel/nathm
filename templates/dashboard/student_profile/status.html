{% extends "dashboard/bases/student-profile.html" %}
{% block title %}Student Profile{% endblock title %}

{% block content %}
    <div class="col-sm-12">
        {% with messages=messages %}
            {% include 'dashboard/alert.html' %}
        {% endwith %}

        <div class="container student_overview_profile">
            <div class="card">
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="d-flex align-items-center">
                                <img src="{{ student.user.profile_image }}" alt="Student Image" class="profile-img">
                                <div class="ms-3">
                                    <h3><strong>Hello,</strong> {{ student.user.first_name }}</h3>
                                    <p class="student_class">Class 2024</p>
                                </div>
                            </div>

                            <p class="mt-4" id="current-date">{{ today_date }}</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <h5>Today's Classes</h5>
                                <i class="fa-solid fa-calendar-days"></i>
                            </div>
                            <div class="list-group">
                                <div class="list-group-item d-flex mb-2">
                                    <div>
                                        <i class="fa-regular fa-clock"></i>
                                    </div>
                                    <div>
                                        <p class="time">10:30 AM - 11:30 AM</p>
                                        <p class="course">Masters in Computing</p>
                                        <p class="user">By Prof. Bijay Baral</p>
                                    </div>
                                </div>
                                <div class="list-group-item d-flex mb-2">
                                    <div>
                                        <i class="fa-regular fa-clock"></i>
                                    </div>
                                    <div>
                                        <p class="time">10:30 AM - 11:30 AM</p>
                                        <p class="course">Masters in Computing</p>
                                        <p class="user">By Prof. Bijay Baral</p>
                                    </div>
                                </div>
                                <div class="list-group-item d-flex mb-2">
                                    <div>
                                        <i class="fa-regular fa-clock"></i>
                                    </div>
                                    <div>
                                        <p class="time">10:30 AM - 11:30 AM</p>
                                        <p class="course">Masters in Computing</p>
                                        <p class="user">By Prof. Bijay Baral</p>
                                    </div>
                                </div>
                                <div class="list-group-item d-flex mb-2">
                                    <div>
                                        <i class="fa-regular fa-clock"></i>
                                    </div>
                                    <div>
                                        <p class="time">10:30 AM - 11:30 AM</p>
                                        <p class="course">Masters in Computing</p>
                                        <p class="user">By Prof. Bijay Baral</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-8">
                            <div class="row">
                                <div class="col-md-6 d-flex align-items-center">
                                    <img src="{% url 'userauth:qrcode' id=student_id %}" alt="QR Code"
                                         style="width: 150px; height: 150px;">
                                    <button class="ms-3 shareBtn">
                                        <i class="fa fa-share fa-lg"></i>
                                        <span>Share</span>
                                    </button>
                                </div>
                                <div class="col-md-6">
                                    <div class="payment_card">
                                        <svg version="1.1" xmlns="http://www.w3.org/2000/svg"
                                             xmlns:xlink="http://www.w3.org/1999/xlink" width="50px" height="50px"
                                             viewBox="0,0,256,256">
                                            <g fill="#86de61" fill-rule="nonzero" stroke="none" stroke-width="1"
                                               stroke-linecap="butt" stroke-linejoin="miter"
                                               style="mix-blend-mode:normal">
                                                <g transform="scale(5.12,5.12)">
                                                    <path d="M20.625,9c-1.44922,0 -2.62891,0.71875 -3.40625,1.625c-0.20312,0.23438 -0.37891,0.49609 -0.53125,0.75c-0.48047,-0.18359 -0.96094,-0.28906 -1.40625,-0.3125c-0.73828,-0.03516 -1.39844,0.125 -1.96875,0.4375c-1.13672,0.625 -1.9375,1.57422 -2.78125,2.28125c-0.86328,0.72266 -3.44531,2.62109 -5.75,4.28125c-2.30469,1.66016 -4.34375,3.125 -4.34375,3.125c-0.35547,0.17188 -0.57422,0.53516 -0.5625,0.92969c0.01172,0.39453 0.25391,0.74609 0.61719,0.89453c0.36719,0.15234 0.78516,0.07422 1.07031,-0.19922c0,0 2.09375,-1.45703 4.40625,-3.125c2.3125,-1.66797 4.83984,-3.50781 5.875,-4.375c1.00391,-0.84375 1.77734,-1.69922 2.4375,-2.0625c0.54688,-0.30078 0.98047,-0.39844 1.78125,0c-0.01562,0.13672 -0.0625,0.26953 -0.0625,0.40625v11.90625l-1.375,0.625c-0.36719,0.11328 -0.63672,0.43359 -0.69141,0.8125c-0.05469,0.38281 0.11719,0.76172 0.4375,0.97656c0.32031,0.21094 0.73438,0.22266 1.06641,0.02344l9.25,-4.25h0.03125c1.31641,-0.70312 2.69531,-1.34766 3.75,-1.5625c1.05469,-0.21484 1.58203,-0.125 2.03125,0.46875c0.52734,0.69531 0.64844,1.46094 0.40625,2.3125c-0.24219,0.85156 -0.88672,1.77344 -2,2.5625c-2.33203,1.64844 -5.9375,2.875 -5.9375,2.875l-0.1875,0.0625l-0.15625,0.125c-1.85547,1.57813 -2.92969,3.07813 -4.28125,4.09375c-1.35156,1.01563 -3.02344,1.6875 -6.46875,1.6875h-0.0625l-10.875,0.625c-0.55078,0.03516 -0.97266,0.51172 -0.9375,1.0625c0.03516,0.55078 0.51172,0.97266 1.0625,0.9375l10.8125,-0.625c0.02344,0 0.03906,0 0.0625,0c2.55469,-0.00781 4.41016,-0.42969 5.875,-1.09375c0.25391,0.75 0.77734,1.39063 1.59375,1.65625c1.14844,0.37109 2.28125,0.26172 3.1875,-0.125c0.40234,-0.17187 0.76953,-0.40625 1.09375,-0.65625c0.31641,0.72656 0.88281,1.40625 1.75,1.71875c0.91016,0.32813 1.81641,0.40234 2.625,0.1875c0.80859,-0.21484 1.46875,-0.67187 2.09375,-1.25c0.10547,-0.09766 0.17578,-0.17187 0.25,-0.25c0.21094,0.14453 0.45313,0.24219 0.71875,0.3125c1.29688,0.33984 2.8125,-0.03125 3.96875,-1.1875c1.01563,-1.01562 1.625,-2.57422 1.84375,-4.6875h8.71875c2.40234,0 4.34375,-1.96875 4.34375,-4.375v-15.0625c0,-2.50781 -2.16406,-4.5625 -4.625,-4.5625zM20.625,11h24.75c1.24609,0 2.625,1.33203 2.625,2.5625v0.4375h-30v-0.34375c0,-0.41406 0.26953,-1.16016 0.75,-1.71875c0.48047,-0.55859 1.08594,-0.9375 1.875,-0.9375zM18,18h30v10.625c0,1.33203 -1.03906,2.375 -2.34375,2.375h-18.875c1.05078,-0.48047 2.21094,-1.05469 3.28125,-1.8125c1.41797,-1.00391 2.39063,-2.27344 2.78125,-3.65625c0.39063,-1.38281 0.14453,-2.87891 -0.75,-4.0625c-0.97656,-1.28906 -2.59375,-1.51172 -4.03125,-1.21875c-1.41797,0.28906 -2.86719,0.96875 -4.21875,1.6875c-0.01953,0.01172 -0.04297,0.01953 -0.0625,0.03125l-5.78125,2.65625zM23,33h0.6875c-0.05859,0.70313 -0.16016,1.76172 -0.28125,2.4375c-0.01562,0.08203 -0.01953,0.16406 -0.03125,0.25c-0.05469,0.03516 -0.10937,0.07813 -0.15625,0.125c-0.42969,0.51172 -0.92578,0.9375 -1.4375,1.15625c-0.51172,0.21875 -1.02344,0.29688 -1.75,0.0625c-0.17969,-0.05859 -0.38281,-0.34766 -0.40625,-0.8125c1.28906,-0.98437 2.23828,-2.10156 3.375,-3.21875zM25.71875,33h3.75c-0.07031,0.46484 -0.13281,0.99609 -0.1875,1.53125c-0.06641,0.65234 -0.125,1.43359 0.03125,2.21875c-0.05469,0.07422 -0.07812,0.08984 -0.15625,0.1875c-0.16406,0.20703 -0.45703,0.50781 -0.34375,0.40625c-0.49219,0.45313 -0.90625,0.71094 -1.28125,0.8125c-0.375,0.10156 -0.76953,0.07422 -1.40625,-0.15625c-0.33984,-0.12109 -0.51562,-0.33984 -0.65625,-0.75c-0.14062,-0.41016 -0.17969,-0.99219 -0.09375,-1.46875c0.17188,-0.94531 0.29297,-2.15234 0.34375,-2.78125zM31.5,33h3.40625c-0.20703,1.67188 -0.67187,2.73438 -1.21875,3.28125c-0.74219,0.74609 -1.37109,0.83594 -2.0625,0.65625c-0.23047,-0.0625 -0.25,-0.11719 -0.34375,-0.53125c-0.09375,-0.41406 -0.09375,-1.0625 -0.03125,-1.65625c0.06641,-0.64062 0.16406,-1.26172 0.25,-1.75z"/>
                                                </g>
                                            </g>
                                        </svg>
                                        <div class="label">No Payment Due</div>
                                    </div>
                                </div>
                            </div>

                            <div class="row justify-content-center mt-4">
                                <div class="col-md-4">
                                    <h5>Books</h5>
                                    <div class="book_cards">
                                        <div>
                                            <span class="value">{{ borrowed_ebooks }}</span>
                                            <span class="label">eBooks</span>
                                        </div>
                                        <div>
                                            <span class="value">{{ borrowed_physical_books }}</span>
                                            <span class="label">Physical</span>
                                        </div>
                                    </div>

                                    <button type="button" class="mt-2 requestBtn rounded-pill px-4"
                                            data-bs-toggle="modal" data-bs-target="#libraryModal">
                                        Request Books
                                    </button>
                                </div>

                                <div class="col-md-4">
                                    <h5>Assignments</h5>
                                    <div class="book_cards">
                                        <div>
                                            <span class="value">{{ borrowed_ebooks }}</span>
                                            <span class="label">Submitted</span>
                                        </div>
                                        <div>
                                            <span class="value text-danger">{{ borrowed_physical_books }}</span>
                                            <span class="label">Pending</span>
                                        </div>
                                    </div>
                                    <button class="requestBtn mt-2 rounded-pill px-4">View Detail</button>
                                </div>

                                <div class="col-md-4 text-center">
                                    <div class="d-flex justify-content-center align-items-center text-white grade-box mx-auto mb-2">
                                        <span class="fs-1 fw-bold">A</span>
                                    </div>
                                    <p><strong>Grade</strong></p>
                                </div>
                            </div>

                            <div class="row mt-5">
                                <div class="col-md-12">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <h5>Notices</h5>
                                        <a href="#" class="text-muted">View All</a>
                                    </div>
                                    <ul class="list-unstyled">
                                        <li class="d-flex justify-content-between py-2 border-bottom">
                                            <div>
                                                <small class="text-muted">27th Sep</small>
                                                <p class="mb-0"><strong>New Books Added to library</strong></p>
                                            </div>
                                        </li>
                                        <li class="d-flex justify-content-between py-2 border-bottom">
                                            <div>
                                                <small class="text-muted">27th Sep</small>
                                                <p class="mb-0"><strong>New Assignment from Bijay Sir with deadline on
                                                    15th Oct</strong></p>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal fade" id="libraryModal" tabindex="-1" aria-labelledby="libraryModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="libraryModalLabel">Request a Book</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form method="post" id="libraryForm">
                        {% csrf_token %}

                        {{ library_form.book.label_tag }}
                        {{ library_form.book }}

                        {{ library_form.return_date.label_tag }}
                        {{ library_form.return_date }}

                        <button type="submit" class="btn btn-primary mt-2">Submit</button>
                    </form>
                    {% if library_form.errors %}
                        <div class="alert alert-danger mt-2">
                            <ul>
                                {% for field in library_form %}
                                    {% for error in field.errors %}
                                        <li>{{ error }}</li>
                                    {% endfor %}
                                {% endfor %}
                                {% for error in library_form.non_field_errors %}
                                    <li>{{ error }}</li>
                                {% endfor %}
                            </ul>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

{% endblock %}